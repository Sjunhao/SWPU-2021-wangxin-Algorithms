import numpy as np
import networkx as nx
import matplotlib.pyplot as plt


def malwarePropagation():
    # graph=[[1,1,0],
    #        [1,1,0],
    #        [0,0,1]]
    # initial=[0,1,2]
    # graph = [[1, 0, 0, 0], [0, 1, 0, 0], [0, 0, 1, 1], [0, 0, 1, 1]]
    # initial = [3, 1]
    # graph = [[1,0,0,0,0,0],[0,1,0,0,0,0],[0,0,1,0,0,0],[0,0,0,1,1,0],[0,0,0,1,1,0],[0,0,0,0,0,1]]
    # initial =[5,0]
    graph = [[1, 1, 0, 0, 0, 0, 0, 0, 0, 0],
             [1, 1, 0, 0, 0, 0, 0, 0, 0, 1],
             [0, 0, 1, 0, 1, 0, 0, 0, 0, 1],
             [0, 0, 0, 1, 0, 0, 0, 0, 0, 1],
             [0, 0, 1, 0, 1, 0, 1, 0, 0, 1],
             [0, 0, 0, 0, 0, 1, 1, 0, 0, 0],
             [0, 0, 0, 0, 1, 1, 1, 0, 0, 1],
             [0, 0, 0, 0, 0, 0, 0, 1, 1, 0],
             [0, 0, 0, 0, 0, 0, 0, 1, 1, 0],
             [0, 1, 1, 1, 1, 0, 1, 0, 0, 1]]
    #可视化图
    # graph_ = nx.Graph(np.asarray(graph))
    # nx.draw(graph_,with_labels=True)
    # plt.show()

    initial = [9, 0, 2]
    initial.sort()
    # graph= [[1,0,1,0],[0,1,0,0],[1,0,1,0],[0,0,0,1]]
    # initial= [1]
    subGraph = [i for i in range(len(graph[0]))]

    for i in range(len(graph)):
        for j in range(i+1, len(graph[i])):
            if graph[i][j] == 1:
                # subGraph[j] = subGraph[i]
                if subGraph[j]==j:
                    subGraph[j] = subGraph[i]
                else:
                    subGraph[i]=subGraph[j]
    for i in range(len(subGraph)):
        if subGraph[subGraph[i]]!=subGraph[i]:
            subGraph[i] = subGraph[subGraph[i]]

    temp = {}
    sub = {}
    for i in subGraph:  # 各个子图的大小
        temp[i] = temp.get(i, 0) + 1
    for i in initial:  # 同一子图被感染的个数
        sub[subGraph[i]] = sub.get(subGraph[i], 0) + 1
    # print('子图构成subGraph：', subGraph)
    # print('子图大小temp：', temp)
    # print("同一子图感染sub:", sub)
    temp_ans = []

    for k, v in sub.items():  # 如果存在子图只有一个被感染的
        if v == 1:
            temp_ans.append(k)
    # print('temp_ans:', temp_ans)
    if len(temp_ans) == 0:
        print(min(initial))
    else:
        max_v = temp[temp_ans[0]]
        max_l = temp_ans[0]
        # print(max_v, max_l)
        for i in temp_ans:
            if max_v < temp[i]:
                max_l = i
                max_v = temp[i]
        # print(max_v, max_l)
        for i in initial:
            if max_l == subGraph[i]:
                print(i)


malwarePropagation()
